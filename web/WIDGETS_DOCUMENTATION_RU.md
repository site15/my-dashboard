# Документация по виджетам проекта "Мой Дашборд"

## Обзор

В этом документе описана реализация виджетов в проекте "Мой Дашборд". В настоящее время реализован один виджет - виджет отслеживания привычек (Habits Widget), который позволяет пользователям отслеживать свои ежедневные привычки и активности.

## Реализованные виджеты

### Виджет отслеживания привычек (Habits Widget)

Виджет отслеживания привычек позволяет пользователям отслеживать свои ежедневные привычки и активности с помощью интерактивного интерфейса.

#### Особенности виджета:

1. **Отображение на дашборде**:
   - Компактное представление с иконками первых 3 привычек
   - Прогресс-бары для каждой привычки
   - Счетчики текущих значений
   - Возможность раскрытия полного интерфейса по клику

2. **Модальное окно**:
   - Вкладки: "Счетчики" и "История"
   - Интерактивные кнопки +/- для увеличения/уменьшения значений
   - Визуализация прогресса с цветовой индикацией
   - История потребления с времennыми метками

3. **Поддерживаемые типы привычек**:
   - Вода (droplet)
   - Еда (utensils)
   - Медикаменты (pill)
   - Упражнения (dumbbell)
   - Кофе (coffee)
   - Стакан воды (glass-water)
   - Яблоко (apple)
   - Вес (weight)
   - Пульс (heart-pulse)
   - Осознанность (brain)
   - Чтение (book)
   - Музыка (music)
   - ТВ/Фильмы (tv)
   - Игры (gamepad)
   - Сон (bed)
   - Солнце (sun)
   - Луна (moon)
   - Звезда (star)
   - Улыбка (smile)
   - Активность (activity)

4. **Цветовые схемы**:
   - Синий (blue)
   - Оранжевый (orange)
   - Фиолетовый (purple)
   - Зеленый (green)
   - Красный (red)
   - Желтый (yellow)
   - Розовый (pink)

#### Техническая реализация:

##### Файлы реализации:
- `web/src/server/widgets/habits-widget.ts` - Основной класс виджета и шаблон отображения
- `web/src/server/widgets/habits-widget.utils.ts` - Вспомогательные функции на стороне клиента

##### Структура данных:
```typescript
interface HabitsWidgetItem {
  id: string;
  name: string;
  icon: string;
  color: string;
  minValue: number;
  maxValue: number;
  currentValue: number;
  history: Array<{
    id: number;
    time: string;
  }>;
}
```

##### Основные функции:
- `showHabitsModal(modalId)` - Отображение модального окна
- `hideHabitsModal(modalId)` - Скрытие модального окна
- `addItem(itemId)` - Увеличение значения привычки
- `removeItem(itemId)` - Уменьшение значения привычки
- `switchHabitsTab(modalId, tabName)` - Переключение между вкладками
- `renderConsumptionList(modalId)` - Отображение истории потребления

#### Интеграция с системой:

Виджет интегрирован с общей системой виджетов проекта и использует следующие компоненты:
- Zod схемы для валидации данных
- Formly для конфигурации формы настройки виджета
- Lucide Icons для иконок
- Tailwind CSS для стилизации

#### Пример конфигурации виджета:

```json
{
  "type": "habits",
  "name": "Daily Habits",
  "items": [
    {
      "id": "water",
      "name": "Water",
      "icon": "droplet",
      "color": "blue",
      "minValue": 0,
      "maxValue": 8,
      "currentValue": 0,
      "history": []
    }
  ]
}
```

## План развития виджетов

### Ближайшие задачи:
1. Реализация дополнительных виджетов (часы, календарь)
2. Улучшение системы настройки виджетов
3. Добавление возможности сохранения состояния виджетов в базе данных
4. Реализация системы логирования изменений виджетов

### Долгосрочные цели:
1. Создание расширяемой системы виджетов с возможностью добавления новых типов
2. Реализация механизма обмена виджетами между пользователями
3. Добавление системы уведомлений для виджетов
4. Создание мобильного интерфейса для взаимодействия с виджетами

## Решение проблем

### Известные проблемы:
1. Некоторые цветовые классы Tailwind CSS не генерируются автоматически для пользовательских цветов
2. Для корректной работы некоторых функций требуется глобальная область видимости

### Рекомендации:
1. При добавлении новых цветов убедитесь, что они корректно отображаются в Tailwind CSS
2. При разработке новых виджетов следуйте установленным паттернам реализации
3. Используйте предоставленные утилиты для работы с DOM вместо прямого обращения к элементам