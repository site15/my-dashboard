# Документация по виджетам проекта "Мой Дашборд"

## Обзор

В этом документе описана реализация виджетов в проекте "Мой Дашборд". В настоящее время реализовано несколько виджетов, включая виджет отслеживания привычек (Habits Widget), виджет часов (Clock Widget), виджет календаря (Calendar Widget) и виджет счётчика (Counter Widget), которые позволяют пользователям отслеживать свои ежедневные привычки, просматривать время и дату, а также вести счётчики с историей изменений.

## Реализованные виджеты



### Виджет отслеживания привычек (Habits Widget)

Виджет отслеживания привычек позволяет пользователям отслеживать свои ежедневные привычки и активности с помощью интерактивного интерфейса.

#### Особенности виджета:

1. **Отображение на дашборде**:
   - Компактное представление с иконками первых 3 привычек
   - Прогресс-бары для каждой привычки
   - Счетчики текущих значений
   - Возможность раскрытия полного интерфейса по клику

2. **Модальное окно**:
   - Вкладки: "Счетчики" и "История"
   - Интерактивные кнопки +/- для увеличения/уменьшения значений
   - Визуализация прогресса с цветовой индикацией
   - История потребления с временнными метками

3. **Поддерживаемые типы привычек**:
   - Вода (droplet)
   - Еда (utensils)
   - Медикаменты (pill)
   - Упражнения (dumbbell)
   - Кофе (coffee)
   - Стакан воды (glass-water)
   - Яблоко (apple)
   - Вес (weight)
   - Пульс (heart-pulse)
   - Осознанность (brain)
   - Чтение (book)
   - Музыка (music)
   - ТВ/Фильмы (tv)
   - Игры (gamepad)
   - Сон (bed)
   - Солнце (sun)
   - Луна (moon)
   - Звезда (star)
   - Улыбка (smile)
   - Активность (activity)

4. **Цветовые схемы**:
   - Синий (blue)
   - Оранжевый (orange)
   - Фиолетовый (purple)
   - Зеленый (green)
   - Красный (red)
   - Желтый (yellow)
   - Розовый (pink)

#### Техническая реализация:

##### Файлы реализации:

- `web/src/server/widgets/habits-widget.ts` - Основной класс виджета и шаблон отображения
- `web/src/server/widgets/habits-widget.utils.ts` - Вспомогательные функции на стороне клиента

##### Структура данных:

```typescript
interface HabitsWidgetItem {
  id: string;
  name: string;
  icon: string;
  color: string;
  minValue: number;
  maxValue: number;
  history: Array<{
    id: number;
    time: string;
  }>;
}
```

##### Основные функции:

- `showHabitsModal(modalId)` - Отображение модального окна
- `hideHabitsModal(modalId)` - Скрытие модального окна
- `addItem(itemId)` - Увеличение значения привычки
- `removeItem(itemId)` - Уменьшение значения привычки
- `switchHabitsTab(modalId, tabName)` - Переключение между вкладками
- `renderConsumptionList(modalId)` - Отображение истории потребления

#### Интеграция с системой:

Виджет интегрирован с общей системой виджетов проекта и использует следующие компоненты:

- Zod схемы для валидации данных
- Formly для конфигурации формы настройки виджета
- Lucide Icons для иконок
- Tailwind CSS для стилизации

#### Пример конфигурации виджета:

```json
{
  "type": "habits",
  "name": "Daily Habits",
  "items": [
    {
      "id": "water",
      "name": "Water",
      "icon": "droplet",
      "color": "blue",
      "minValue": 0,
      "maxValue": 8,
      "history": []
    }
  ]
}
```

### Виджет часов (Clock Widget)

Виджет часов отображает текущее время с настраиваемым часовым поясом и названием.

#### Особенности виджета:

1. **Отображение на дашборде**:
   - Показывает текущее время в формате ЧЧ:ММ:СС
   - Настраиваемый часовой пояс
   - Настраиваемое имя/название отображения
   - Поддержка 12/24 часового формата

2. **Параметры настройки**:
   - Выбор часового пояса
   - Отображаемое имя
   - Выбор формата 12/24 часа
   - Пользовательские параметры стилизации

#### Техническая реализация:

##### Файлы реализации:
- `web/src/server/widgets/clock-widget.ts` - Основной класс виджета и шаблон отображения
- `web/src/server/widgets/clock-widget.utils.ts` - Вспомогательные функции на стороне клиента

##### Структура данных:
```typescript
interface ClockWidgetOptions {
  timeZone: string;
  name: string;
  format24Hour: boolean;
}
```

### Виджет календаря (Calendar Widget)

Виджет календаря отображает текущую дату с настраиваемым месяцем и числом.

#### Особенности виджета:

1. **Отображение на дашборде**:
   - Показывает текущую дату с днем, месяцем и годом
   - Настраиваемый фиксированный месяц и число
   - Отображение дня недели
   - Полное название месяца

2. **Параметры настройки**:
   - Выбор фиксированного месяца
   - Выбор фиксированной даты
   - Пользовательские параметры стилизации

#### Техническая реализация:

##### Файлы реализации:
- `web/src/server/widgets/calendar-widget.ts` - Основной класс виджета и шаблон отображения
- `web/src/server/widgets/calendar-widget.utils.ts` - Вспомогательные функции на стороне клиента

##### Структура данных:
```typescript
interface CalendarWidgetOptions {
  month: number;
  date: number;
  fixedDate: boolean;
}
```



## План развития виджетов

### Ближайшие задачи:

1. Улучшение системы настройки виджетов
2. Добавление возможности сохранения состояния виджетов в базе данных
3. Реализация системы логирования изменений виджетов

### Долгосрочные цели:

1. Создание расширяемой системы виджетов с возможностью добавления новых типов
2. Реализация механизма обмена виджетами между пользователями
3. Добавление системы уведомлений для виджетов
4. Создание мобильного интерфейса для взаимодействия с виджетами

## Решение проблем

### Известные проблемы:

1. Некоторые цветовые классы Tailwind CSS не генерируются автоматически для пользовательских цветов
2. Для корректной работы некоторых функций требуется глобальная область видимости

### Рекомендации:

1. При добавлении новых цветов убедитесь, что они корректно отображаются в Tailwind CSS
2. При разработке новых виджетов следуйте установленным паттернам реализации
3. Используйте предоставленные утилиты для работы с DOM вместо прямого обращения к элементам
